<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="Blog Post" description="Post to blog" author="haitai" author_email="haitai@gmail.com" category="tools" height="500">
<Require feature="opensocial-0.8"/>
<Require feature="dynamic-height"/>
<Require feature="views"/>
<Optional feature="maximize"/>
<Optional feature="setprefs"/>
</ModulePrefs>
<Content type="html" view="home, profile">
<![CDATA[
<script type="text/javascript">
  function goToView(dest) {
    var supported_views = gadgets.views.getSupportedViews();
    gadgets.views.requestNavigateTo(supported_views[dest]);
  };
</script>
<center> <a href="javascript:goToView('canvas')" >Write a post</a> </center>
<script type="text/javascript">
gadgets.window.adjustHeight();
</script>
]]>
</Content>
<Content type="html" view="default,canvas">
<![CDATA[
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="http://log.huhaitai.com/static/markitup/skins/simple/style.css" />
<link rel="stylesheet" type="text/css" href="http://log.huhaitai.com/static/markitup/sets/html/style.css" />
<script type="text/javascript" src="http://log.huhaitai.com/static/markitup/jquery.markitup.js"></script>
<script type="text/javascript" src="http://log.huhaitai.com/static/markitup/sets/html/set.js"></script>
<script type="text/javascript" >
$.postJSON = function(url, data, callback) {
    $.post(url, data, callback, "json");
}
   $(document).ready(function() {
    $("#id_body").markItUp(mySettings);
    $("form").submit(function() {
        var title = $("input[name='title']").val();    
        var slug = $("input[name='slug']").val();
        var body = $("input[name='body']").val();
        var tags = $("input[name='tags']").val();
        $.postJSON('http://log.huhaitai.com/gadget_post', {title:title,slug:slug,body:body,tags:tags}, function(data) {
            if (data.success) {
                $("#message").html("success!");
            }
        });
    });
   });
</script>
<form id="gadget_post" method="post">
<table>
<tr><th><label for="id_title">Title:</label></th><td><input type="text" name="title" id="id_title" /></td></tr>
<tr><th><label for="id_slug">Slug:</label></th><td><input type="text" name="slug" id="id_slug" /></td></tr>
<tr><th><label for="id_body">Body:</label></th><td><textarea id="id_body" rows="10" cols="40" name="body"></textarea></td></tr>
<tr><th>Tags:</th><td><input type="text" name="tags" value="" id="id_tags" />(Comma separated)</td></tr>
<tr><th></th><td><div style="margin-top: 1em;"><input id="id_submit" type="submit" value="Post"/><div id="message"></div></div></td></tr>
</table>
</form>

]]>
</Content>
</Module>